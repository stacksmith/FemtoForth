platform-specific code is segregated here
